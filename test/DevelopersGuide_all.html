<HTML><BODY LANG="en-US" LINK="#0000ff" DIR="LTR"><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0.14in"><img src="resources/health-logo.png"  WIDTH="244" HEIGHT="62" BORDER="0"/></P><P CLASS="western" ALIGN="CENTER" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" ALIGN="CENTER" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" ALIGN="CENTER" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" ALIGN="CENTER" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" ALIGN="CENTER" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></p><TABLE DIR="LTR" ALIGN="RIGHT" WIDTH="319" HSPACE="4" CELLPADDING="7" CELLSPACING="0">	<col WIDTH=303 />	<TR>		<TD WIDTH="303" VALIGN="TOP" STYLE="border-top: 2.00pt solid #0055a6; border-bottom: 1.00pt solid #0055a6;  padding: 0in 0.08in;border-left: none; border-right: none;">			<P CLASS="western" ALIGN="JUSTIFY" STYLE="margin-top: 0.17in"><FONT COLOR="#646464"><FONT SIZE="5"><B>ChemDrawDirect 1.7.1</B></FONT></FONT></P>		</TD>	</TR>	<TR>		<TD WIDTH="303" VALIGN="TOP" STYLE="border-top: 1.50pt solid #0055a6; border-bottom: 2.00pt solid #0055a6; padding: 0in 0.08in;border-left: none; border-right: none;">			<P CLASS="western" STYLE="margin-top: 0.17in"><FONT COLOR="#000000"><FONT SIZE="4"><B>Developer's Guide</B></FONT></FONT></P>		</TD>	</TR></TABLE><BR/><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"></P><P CLASS="western" STYLE="margin-bottom: 0.14in"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></p><img src="C:/Users/LiJe/Desktop/cddw_user_guide_md/test/resources/pki-logo.png" align="right"  WIDTH="149" HEIGHT="81" BORDER="0" /><P CLASS="western" STYLE="margin-bottom: 0.14in"></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"></P><P CLASS="western" STYLE="margin-top: 0.08in; margin-bottom: 0.14in;"><A NAME="_Toc306629693"></A><A NAME="_Toc306628491"></A><A NAME="_Toc306264594"></A><A NAME="_Toc306197978"></A><A NAME="_Toc306192515"></A><A NAME="_Toc306192342"></A><A NAME="_Toc306191405"></A><A NAME="_Toc304373174"></A><A NAME="_Toc304369983"></A><A NAME="_Toc304365007"></A><A NAME="_Toc304301972"></A><A NAME="_Toc303690188"></A></p><TABLE DIR="LTR" ALIGN="LEFT" WIDTH="300" HSPACE="4" CELLPADDING="7" CELLSPACING="0">	<COL WIDTH=97 />	<COL WIDTH=128 />	<TR>		<TD WIDTH="150" HEIGHT="12" STYLE="border-top: 2px solid #0055a6; border-bottom: 2px solid #0055a6; border-left: none; border-right: none;">			<P CLASS="western" STYLE="margin-right: 0.05in"><FONT COLOR="#000000"><B>Last Updated:</B></FONT></P>		</TD>		<TD WIDTH=200 STYLE="border-top: 2px solid #0055a6; border-bottom: 2px solid #0055a6; border-left: none; border-right: none; padding: 0in">			<P CLASS="western">December 02, 2016</P>		</TD>	</TR></TABLE><DIV ID="Table of Contents1" DIR="LTR">	<P STYLE="margin-top: 0.06in; margin-bottom: 0.06in; line-height: 120%"><BR/><BR/></P></DIV><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P><P CLASS="western" STYLE="margin-bottom: 0in; line-height: 100%"><BR/></P></body></html><hr />
<p>title: ChemDraw Direct v1.7.1 Developer&rsquo;s Guide</p>
<p>layout: pkidocs</p>
<hr />
<h1>1 Introduction</h1>
<p>ChemDraw Direct (CDD) is a lightweight JavaScript-based chemical drawing tool built using modern web technologies that can be easily integrated into web-based applications such as PerkinElmer Elements via its published API.</p>
<p>This guide is designed to instruct developers on the development of web-based applications that using ChemDraw Direct. It describes the procedures for loading and attaching it, as well as API usage and functionality.</p>
<h2>1.1 Architecture</h2>
<p>Three typical architectures are supported by ChemDraw Direct to enable host applications to embed ChemDraw functionalities in a suitable way.</p>
<p>The JavaScript library is a must for the host applications to enable basic chemical drawing functions. It consists of the JavaScript source files, cursor resources, and chemical resources.</p>
<p>The ChemDraw Web Service is only required if the host application wants to enable advanced chemical features, such as chemical format converting, structure cleanup, stoichiometry, etc. It runs as a windows service and provides RESTful web service APIs to authorized clients.</p>
<p>Refer to the <em>PerkinElmer ChemDraw Direct 1.7.1 Installation Guide</em> for details about the installation steps.</p>
<h3>1.1.1 Separated Libraries Embedded in Host Applications</h3>
<p>The JavaScript library can be included in any web-based applications. The host application developers have to make sure the scripts and resource files are deployed correctly with the host application. Each host application needs to maintain one copy of the library.  An upgrade on the JavaScript library may cause an upgrade of the entire host application.</p>
<p>If the ChemDraw Web Service is needed, a separate web service has to be deployed in the network. The address of the web service has to be configured manually in the JavaScript library. The web service can be installed on the same server which has the host application running.</p>
<p><br/><img src="resources/ArchitectureSeparatedLibraries.png" alt="SeparatedLibraries" /></p>
<h3>1.1.2	Single ChemDraw Direct Service</h3>
<p>The library and the RESTful web service can be deployed within a single service using the installer of the ChemDraw Direct Service. The service provides the capability of Cross Origin Resource Sharing (CORS) so that the libraries can be accessed from the applications that running in different domains.</p>
<p>The address of the web service is automatically configured in the library by the installer, so that all the host applications can share the same configuration to provide ChemDraw functions to end users.</p>
<p>The ChemDraw Direct Service needs to be maintained by the service professionals or administrators of the host applications. Ideally, an upgrade of ChemDraw Direct Service and host applications has no impact to each other.</p>
<p>The service can be deployed in the same local network with the host applications.</p>
<p><br/><img src="resources/ArchitectureSingleService.png" alt="OneService" /></p>
<h2>1.2 ChemDraw Direct Sample Page</h2>
<p>A sample page of ChemDraw Direct is distributed with the release package or the installer.</p>
<p><br/><img src="resources/IntroductionSamplePage.png" alt="SamplePage" /></p>
<p>This page demonstrates how ChemDraw Direct can be embedded in a web based application and all functions of ChemDraw Direct.</p>
<ul>
<li>The menus on the top call the ChemDraw Direct JavaScript APIs to create new ChemDraw tools and execute document or structure related commands.</li>
</ul>
<ul>
<li>The panel on the right shows the history of the API calls that have been triggered by this sample page.</li>
</ul>
<ul>
<li>Multiple ChemDraw documents can be created on the page by clicking the New button. This demonstrates the right way to handle multiple ChemDraw instances within the same web page.</li>
</ul>
<ul>
<li>The panel that showing the ChemDraw document can be resized, maximized or restored to demonstrate the impact of the containerâ€™s size change.</li>
</ul>
<ul>
<li>Customized configuration can be applied to the current active ChemDraw drawing tool easily by using the &ldquo;Customize&rdquo; tool.</li>
</ul>
<p>With the help of this sample page, it will be easier to understand the APIs that describes in the following sections.</p>
<p><em><strong>Note</strong>: The sample page is using ZeroClipboard to provide &ldquo;copy to clipboard&rdquo; function. It requires Adobe Flash plugin enabled on the browsers.</em></p>
<h1>2	Loading the ChemDraw Direct Module</h1>
<h2>2.1	Loading the Required Scripts</h2>
<p>To gain access to the classes you need to use ChemDraw Direct, you first need to load its module. To do this, you add the required <code>&lt;script&gt;</code> tag:</p>
<pre><code class="language-html"></code></pre>
<script type="text/javascript" src="http://serverurl/1.7/js/chemdrawweb/chemdrawweb.nocache.js"></script>
<script type="text/javascript" src="http://serverurl/1.7/js/chemdrawweb/ChemdrawWebManager.js"></script>
<pre><code></code></pre>
<p>Once this script tag is evaluated, the loading of the module will begin. The loading of the module is asynchronous and the classes in the module will not be available until the loading is complete.</p>
<h2>2.2	Attaching ChemDraw Direct to the DOM Tree</h2>
<pre><code class="language-javascript"></code></pre>
<p>perkinelmer.ChemdrawWebManager.attach(options);</p>
<pre><code></code></pre>
<p>The attach function may be used to attach several instances of ChemDraw to the DOM and may be called at any time. The id or the element parameter has to be specified in the options.</p>
<p><strong>Options</strong></p>
<table>
<tr><th>Name</th><th>Type</th><th>Description</th></tr>
<tr><td>id</td><td>string</td><td>The id of the element in the DOM tree the tool will be attached to.</td></tr>
<tr><td>element</td><td>DOM node</td><td>The DOM element the tool will be attached to.</td></tr>
<tr><td>viewonly</td><td>boolean</td><td>Whether the drawings are editable or not.</td></tr>
<tr><td>config</td><td>JSON object (configuration)</td><td>The configuration object that will be used when attaching ChemDraw.</td></tr>
<tr><td>configUrl</td><td>string (URL)</td><td>The configuration file URL that will be used when attaching ChemDraw.</td></tr>
<tr><td>license</td><td>string</td><td>The license content string.</td></tr>
<tr><td>licenseUrl</td><td>string (URL)</td><td>The license file URL.</td></tr>
<tr><td>callback</td><td>function (drawingTool) {}</td><td>The callback that will be called after the tool is attached. The ChemDraw instance will be passed back as the first parameter of the callback, which can be used to call the APIs.</td></tr>
</table>
<h2>2.3	Basic Template</h2>
<p>Start with this basic HTML template below. It loads the required scripts and attaches the tool to the HTML element with the id &ldquo;drawingTool&rdquo;.</p>
<pre><code class="language-html"></code></pre>
<p></p>
<html>
  <head>
<title>ChemDraw Direct Basic Template</title>
   <script type="text/javascript" src="js/chemdrawweb/chemdrawweb.nocache.js"></script>
<pre><code>	&lt;script type=&quot;text/javascript&quot; src=&quot;js/chemdrawweb/ChemdrawWebManager.js&quot;&gt;&lt;/script&gt;   
</code></pre>
  </head>
  <body>
<pre><code>&lt;div id=&quot;drawingTool&quot; style=&quot;position: absolute; width: 100%; height: 100%; left: 0; top: 0;&quot;&gt;&lt;/div&gt;
</code></pre>
<pre><code>&lt;script&gt;
</code></pre>
<pre><code>    var toolAttached = function(chemdraw) {
</code></pre>
<pre><code>        //ChemDraw drawingTool is ready for use now. Use chemdraw instance to call the APIs
</code></pre>
<pre><code>    };
</code></pre>
<pre><code>    perkinelmer.ChemdrawWebManager.attach({id: &quot;drawingTool&quot;, callback: toolAttached, license: &quot;â€¦&quot;});
</code></pre>
<pre><code>&lt;/script&gt;
</code></pre>
  </body>
</html>
<pre><code></code></pre>
<h2>2.4	License File</h2>
<p>The license file is required to initialize ChemDraw Direct. There is a license file embedded in the ChemDraw Direct installer. This license file has limited features enabled, and some features are not allowed to use, e.g. calling the getSVG, getEPS, getWMF, getEMF APIs.</p>
<p>To use those disabled APIs or PerkinElmer hosted ChemDraw web service, please contact PerkinElmer to acquire a new license file.</p>
<p>The license can be passed to ChemDraw Direct in the attach function by the property &ldquo;licenseUrl&rdquo; (the license file URL) or &ldquo;license&rdquo; (the content of the license file).</p>
<p>The license can also be passed to ChemDraw Direct by setting the variable <em>window.chemdrawweb_licenseUrl</em> (the license file URL) or <em>window.chemdrawweb_license</em> (the license file content).</p>
<p><em><strong>Note</strong>: The license file is hosted by the application server. If the licenseUrl is a relative path, it is relative to the current webpage.</em></p>
<h1>3	Customizing ChemDraw Direct</h1>
<h2>3.1	Configuration File</h2>
<p>ChemDraw Direct JavaScript library contains a configuration file named &ldquo;configuration.json&rdquo;. This file is the preferred configuration to be loaded when loading ChemDraw Direct JavaScript files.</p>
<p>The content of the configuration file is in JSON format. The JSON configuration consists of three parts:</p>
<ul>
<li>theme: defines the custom style of toolbar size, icons, info images, dialogs. The url of theme can be relative path or absolute path;</li>
</ul>
<ul>
<li>features: defines the features to enable and the features to disable;</li>
</ul>
<ul>
<li>layout: defines the orientation and the order of the tools or tool groups;</li>
</ul>
<ul>
<li>properties: defines the application properties which is used in the library. Currently, the address of the ChemDraw Web Service is the only property can be defined in the configuration.</li>
</ul>
<p>The sample page can be used to generate a pretty configuration text in JSON format. Refer to section <em>3.3. Generate Configuration using the Sample Page</em> for details.</p>
<pre><code class="language-json"></code></pre>
<p>{</p>
<pre><code>theme: {
</code></pre>
<pre><code>          name: &quot;chemdraw&quot;,
</code></pre>
<pre><code>          [url: &quot;theme/chemdraw&quot;]
</code></pre>
<p>},</p>
<pre><code>features: {enabled: [â€¦], disabled: [â€¦]},
</code></pre>
<pre><code>layout: {orientation: &quot;â€¦&quot;, tools: [â€¦]},
</code></pre>
<pre><code>properties: {
</code></pre>
<pre><code>	chemservice: &quot;â€¦&quot;,
</code></pre>
<pre><code>	&quot;StyleSheet&quot;: &quot;ACS Document 1996&quot;,
</code></pre>
<pre><code>},
</code></pre>
<pre><code>authentication: {
</code></pre>
<pre><code>	type: &quot;Basic&quot;
</code></pre>
<pre><code>}
</code></pre>
<p>}</p>
<pre><code></code></pre>
<h3>3.1.1	Theme</h3>
<ul>
<li><strong>name</strong>: This is CDD internal theme name. It is a folder inside CDD library. Developers can add their own theme folder on their own CDD server.</li>
</ul>
<ul>
<li><strong>url</strong>: This is the external theme address, which is the link of a folder outside of CDD. In this way, developers can define customized theme without modifying CDD library. The theme folder is deployed on developersâ€™ own application server, which can be a different server from CDD server. The URL can be an absolute link or a relative link to the webpage.</li>
</ul>
<blockquote>
<p><strong>name</strong> and <strong>url</strong> cannot exist at the same time. If developers set both name and url, CDD will only apply name theme.</p>
</blockquote>
<p>In the theme folder, developers need several files to configure the theme such as index.html, xxx.css, and some image files (xxx.png, xxx.gif, xxx.jpg). Index.html is the theme configuration file. It configures the css name and which images should be replaced in CDD. xxx.css is a css style file. Its name is based on configuration in index.html. Images files, their name are based on the configuration in the index.html.</p>
<ul>
<li>index.html: This is a json format file, it configure the css and images information. CDD will accord this configuration to apply the css style and replace the icon in CDD.</li>
</ul>
<ul>
<li>css: Setting the name of css file</li>
</ul>
<ul>
<li>images: Setting the custom images</li>
</ul>
<ul>
<li>name: Image name</li>
</ul>
<ul>
<li>url: Image file URL</li>
</ul>
<pre><code class="language-javascript"></code></pre>
<p>{</p>
<pre><code>&quot;css&quot;:&quot;chemdraw.css&quot;,
</code></pre>
<pre><code>&quot;images&quot; : [
</code></pre>
<pre><code>	{
</code></pre>
<pre><code>		&quot;name&quot;:&quot;ToolBackground_Down&quot;,
</code></pre>
<pre><code>		&quot;url&quot;:&quot;ToolBackground_Down.png&quot;
</code></pre>
<pre><code>	},
</code></pre>
<pre><code>	{
</code></pre>
<pre><code>		&quot;name&quot;:&quot;ToolBackground_Normal&quot;,
</code></pre>
<pre><code>		&quot;url&quot;:&quot;ToolBackground_Normal.png&quot;
</code></pre>
<pre><code>	},
</code></pre>
<pre><code>	{
</code></pre>
<pre><code>		&quot;name&quot;:&quot;Clipboard_Error&quot;,
</code></pre>
<pre><code>		&quot;url&quot;:&quot;Clipboard_Error.png&quot;
</code></pre>
<pre><code>	},
</code></pre>
<pre><code>	{
</code></pre>
<pre><code>		&quot;name&quot;:&quot;Clipboard_Normal&quot;,
</code></pre>
<pre><code>		&quot;url&quot;:&quot;Clipboard_Normal.png&quot;
</code></pre>
<pre><code>	}
</code></pre>
<pre><code>]
</code></pre>
<p>}</p>
<pre><code></code></pre>
<ul>
<li>image files: A set of replaced images files. The name follows the rule. If developers input unsupported name to replace, CDD wonâ€™t apply it to replace the icon. The url is a relative link in the theme folder, this is placed with index.html on the same folder on server.</li>
</ul>
<p>The images reference table, if developers want to replace those images, they should use the images name to input in index.html.</p>
<p>Image file name	Default image</p>
<ul>
<li>chemdraw.css: The css style file overrides the style of cdd. We support developers to replace the CDD tool bar style (size, background, hover and active affect). These css style names are fixed, developers canâ€™t remove or rename them, but developers can add their expected css style name. For example if developers want to change GWT or other css names which are found through web debugger tool, they can add what they want in this css file.</li>
</ul>
<pre><code class="language-html"></code></pre>
<p>.cdd-custom-ToolButton {</p>
<pre><code>background-image: none;
</code></pre>
<pre><code>outline-width: 0px;
</code></pre>
<pre><code>position: relative;
</code></pre>
<pre><code>border: 0px;
</code></pre>
<pre><code>border-radius: 0px;
</code></pre>
<pre><code>text-align: center;
</code></pre>
<pre><code>height: 32px;
</code></pre>
<pre><code>width: 32px;
</code></pre>
<pre><code>padding: 0px;
</code></pre>
<p>}</p>
<p>.cdd-custom-ToolBackground, .cdd-custom-ToolExpandable {</p>
<pre><code>border: 1px solid transparent;
</code></pre>
<pre><code>height: 30px;
</code></pre>
<pre><code>width: 30px;
</code></pre>
<pre><code>margin: 1px;
</code></pre>
<p>}</p>
<p>.gwt-ToggleButton-up-hovering .cdd-custom-ToolBackground:hover,</p>
<p>.gwt-ToggleButton-down-hovering .cdd-custom-ToolBackground:hover,</p>
<p>.gwt-PushButton-up-hovering .cdd-custom-ToolBackground:hover,</p>
<p>.gwt-PushButton-down-hovering .cdd-custom-ToolBackground:hover,</p>
<p>.gwt-ToggleButton-up-hovering .cdd-custom-ToolExpandable:hover,</p>
<p>.gwt-ToggleButton-down-hovering .cdd-custom-ToolExpandable:hover,</p>
<p>.gwt-PushButton-up-hovering .cdd-custom-ToolExpandable:hover,</p>
<p>.gwt-PushButton-down-hovering .cdd-custom-ToolExpandable:hover {</p>
<pre><code>border-color: black;
</code></pre>
<p>}</p>
<p>.cdd-custom-ToolExpandable {</p>
<pre><code>position: absolute;
</code></pre>
<pre><code>left: 0px;
</code></pre>
<p>}</p>
<p>.cdd-custom-ToolIcon {</p>
<pre><code>height: 24px;
</code></pre>
<pre><code>width: 24px;
</code></pre>
<pre><code>position: absolute;
</code></pre>
<pre><code>margin-top: 4px;
</code></pre>
<pre><code>margin-left: 4px;
</code></pre>
<pre><code>pointer-events: none;
</code></pre>
<p>}</p>
<p>.cdd-custom-ToolBar {</p>
<pre><code>background-color: #EDEDED;
</code></pre>
<p>}</p>
<pre><code></code></pre>
<h3>3.1.2	Features</h3>
<p>Following two lists are used to define the enabled or disabled features in the configuration.</p>
<ul>
<li>Configuration.features.enabled</li>
</ul>
<ul>
<li>Configuration.features.disabled</li>
</ul>
<p>The following features can be enabled or disabled in the configuration.</p>
<ul>
<li>HydrogenCalculation: Controls whether the hydrogen calculation should be performed when loading or modifying a chemical structure or not.</li>
</ul>
<ul>
<li>ChemTranslation: Controls whether the API calls for translating CDXML to other formats, such as SMILES, MOL, etc., should be enabled or not.</li>
</ul>
<ul>
<li>CopyPaste: Controls whether the copy &amp; paste tools should be displayed or not, and controls whether the hotkeys should be enabled or not.</li>
</ul>
<ul>
<li>GroupUngroup: Controls whether the group/ungroup tools should be displayed and the hotkeys are all disabled.</li>
</ul>
<ul>
<li>FileDrop: Controls whether the CDXML files can be loaded to the ChemDraw Direct by dragging and dropping a file on the canvas.</li>
</ul>
<ul>
<li>LogoLink: Controls whether a hyperlink should be added on the logo which shows on the right bottom of the drawing tool. Clicking the hyperlink will open PerkinElmerâ€™s web site.</li>
</ul>
<ul>
<li>WarningsForQueries: Controls whether the warnings for queries should be shown.</li>
</ul>
<ul>
<li>WarningsForLonePairDivalentConversion: Controls whether the warnings for long pair divalent conversion should be shown.</li>
</ul>
<ul>
<li>AutoUpdateStructureName: Controls whether the generated name should be updated automatically once the linked structure is modified.</li>
</ul>
<ul>
<li>ContractExpand: Controls whether the expand/contract tools should be displayed and the features are enabled.</li>
</ul>
<ul>
<li>ExtendedCopyPaste: Controls whether the clipboard extension should be loaded or not, and controls whether the features should be enabled or not.</li>
</ul>
<ul>
<li>WarningsForDataLoss: Controls whether the warnings for queries should be shown.</li>
</ul>
<ul>
<li>MessageCenter: Controls whether the information, warnings, errors icon and details should be shown on the left bottom or not.</li>
</ul>
<ul>
<li>Arrows: Controls whether the arrows group tool should be displayed or not.</li>
</ul>
<p>The tools can also be controlled by adding the name of the tool into the enabled or disabled feature list in the configuration. Once a tool is disabled in the configuration, it will not be visible to the end users.</p>
<h3>3.1.3	Tools Orientation</h3>
<p>The orientation of the tools can be set by Configuration.layout.orientation.</p>
<p>â€ƒ</p>
<p>Orientation: Horizontal</p>
<p>Orientation: Vertical</p>
<p>Orientation: Mixed</p>
<h3>3.1.4	Tool Group and Shrink</h3>
<p>When the container of the attached drawing tool is not large enough to show the entire toolbar, the tool groups shrink.</p>
<p>Following are the three tool groups already supported by ChemDraw Direct.</p>
<ul>
<li>Symbols: CirclePlus, CircleMinus, LonePair, Radical</li>
</ul>
<ul>
<li>Bonds: SolidBond, BoldBond, DoubleBond, TripleBond, HashedWedgeBond, WedgeBond, DashedBond</li>
</ul>
<ul>
<li>Rings: Propane, Butane, Pentane, Hexane, Benzene, CyclohexaneChairRight, CyclohexaneChairLeft</li>
</ul>
<ul>
<li>Arrows: SolidArrow, DashedArrow, NoGoArrow, ResonanceArrow, HollowArrow</li>
</ul>
<p>When the tools are not defined in the groups, shrinking of these tools is disabled.</p>
<h3>3.1.5	ChemDraw Web Service</h3>
<p>The address of the ChemDraw Web Service can be set by Configuration.properties.chemservice .</p>
<h2>3.2	Loading Customized Configuration</h2>
<p>The default configuration is stored in the library. It can be modified to be the customized configuration, if developers have write access to that file. Then all web pages using the same library can load this customized configuration.</p>
<p>Customizing the central default configuration is not applicable to for the host application that loads the scripts from the CloudFront service that hosted by PerkinElmer.</p>
<h3>3.2.1	Loading Customized Configuration in attach()</h3>
<p>The section 2.3 Attaching ChemDraw Direct to the DOM Tree described how to attach a ChemDraw drawing tool to DOM. Two options can be used to specify the configuration to load when attaching.</p>
<p>Using the config option</p>
<pre><code class="language-javascript"></code></pre>
<p>var configJson = {  features: {enabled: [], disabled: []}, layout: {orientation: &ldquo;â€¦&rdquo;, tools: []}, properties: {chemservice: &ldquo;â€¦&rdquo;}};</p>
<p>perkinelmer.ChemdrawWebManager.attach({id: &ldquo;cddContainer&rdquo;, config: configJson);</p>
<pre><code></code></pre>
<p>Using the configUrl option</p>
<pre><code class="language-javascript"></code></pre>
<p>var configUrl = &ldquo;<a href="https://fakeurl/sample.conf">https://fakeurl/sample.conf</a>&rdquo;;</p>
<p>perkinelmer.ChemdrawWebManager.attach({id: &ldquo;cddContainer&rdquo;, configUrl: configUrl);</p>
<pre><code></code></pre>
<p>The configuration loaded in the attach() can only be applied to the drawing tool that being attached. The other drawing tools on the same web page are not affected.</p>
<h4>3.2.2	Loading Customized Configuration in chemdrawweb_config</h4>
<p>The ChemdrawWebManager will try to read the variable window.chemdrawweb_config to see if it is set before attaching the drawing tool to the DOM. If valid value exists, the drawing tool will apply the configuration to all the drawing tools that attached to the current page.</p>
<p>A JavaScript file can be written to include the script below.</p>
<pre><code class="language-javascript"></code></pre>
<p>// e.g. Save the script below as conf/configuration.js</p>
<p>window.chemdrawweb_config = {</p>
<pre><code>features: {enabled: [â€¦], disabled: [â€¦]},
</code></pre>
<pre><code>layout: {orientation: &quot;â€¦&quot;, tools: [â€¦]},
</code></pre>
<pre><code>properties: {chemservice: &quot;â€¦&quot;}};
</code></pre>
<pre><code></code></pre>
<p>Add the script tag in the head of the HTML pages.</p>
<pre><code class="language-html"></code></pre>
<html>
  <head>
<script type="text/javascript" src="conf/configuration.js"></script>
  </head>
<pre><code>&lt;body&gt;&lt;/body&gt;
</code></pre>
</html>
<pre><code></code></pre>
<p>Using the variable chemdrawweb_config developers do not need to specify the config options when attaching a ChemDraw drawing tool to the DOM. It will be helpful when there are several places in the host web page calling the attach() function.</p>
<h3>3.2.3	Loading Customized Configuration in chemdrawweb_configUrl</h3>
<p>The ChemdrawWebManager will try to read the variable window.chemdrawweb_configUrl (after the window.chemdrawweb_config) to see if it is set before attaching the drawing tool to the DOM. If valid value exists, the drawing tool will apply the configuration to all the drawing tools that attached to the current page.</p>
<h2>3.3	Generate Configuration using the Sample Page</h2>
<p>The sample page provides a customize tool which allows user to try different configurations on the current drawing tool. It also allows user to generate the configuration text in JSON, so that the content can be copied and written to the configuration file of the library.</p>
<p>The dialog of customizing ChemDraw Direct shows after the Customize button is clicked.</p>
<p>Clicking the Apply button will make the current ChemDraw load the customized configuration immediately.  The modified values will not be kept after the dialog hides.</p>
<p>Clicking the Generate Configuration button, the configuration text in JSON will be displayed on another popup dialog which enables user to copy the whole content of the configuration.</p>
<h1>4	Using the API</h1>
<p>ChemDraw Direct publishes several API functions, which lets developers interact with ChemDraw programmatically. All API calls are made against the ChemDraw Direct Object. The API functions are detailed below.</p>
<h2>4.1	API Functions</h2>
<h3>4.1.1	getInChI(callback)</h3>
<p>This function translates the current drawing into an InChI representation. This call is asynchronous and a callback function must be provided that is informed when the results are available.  A second parameter is also provided in the callback function, which is a String that describes errors that occurred during the translation.</p>
<p>Example:</p>
<pre><code class="language-html"></code></pre>
<script>
<pre><code>    function chemdrawLoaded() {
</code></pre>
<pre><code>        cdw = new perkinelmer.ChemdrawWeb();
</code></pre>
<pre><code>        cdw.attach(&quot;cdwAnchor&quot;);
</code></pre>
<pre><code>    }
</code></pre>
<pre><code>    function showInChI() {
</code></pre>
<pre><code>        cdw.getInChI(function(inchiStr, error) {
</code></pre>
<pre><code>             if(error) {alert(&quot;Error during translation: &quot; + error);}
</code></pre>
<pre><code>             else {alert(&quot;The InChI String is: &quot; + inchiStr);}
</code></pre>
<pre><code>        });
</code></pre>
<pre><code>   }
</code></pre>
</script>
<pre><code></code></pre>
<h3>4.1.2	getInChIKey(callback)</h3>
<p>This function is identical to the other translation methods except that it returns an InChIKey representation of the current drawing.</p>
<h3>4.1.3	getSMILES(callback)</h3>
<p>This function is identical to the other translation methods except that it returns a SMILES representation of the current drawing.</p>
<h3>4.1.4	getRXN(callback)</h3>
<p>This function is identical to the other translation methods except that it returns a RXN representation of the current drawing.</p>
<h3>4.1.5	getMOL(callback)</h3>
<p>This function is identical to the other translation methods except that it returns a MOL representation of the current drawing.</p>
<h3>4.1.6	loadCDXML(cdxml)</h3>
<p>This function reads a CDXML string and loads its contents into ChemDraw.</p>
<h3>4.1.7	getCDXML()</h3>
<p>This function returns a CDXML string representing the current drawing.</p>
<h3>4.1.8	clear()</h3>
<p>This function clears the current contents of ChemDraw.</p>
<p>This operation is not undoable. And ChemDraw will not prompt the user to confirm the operation.</p>
<h3>4.1.9	getImgUrl()</h3>
<p>This function returns a URL string which points to a PNG representation of the current drawing. The image contents are encoded in the URL so it may be used offline.</p>
<p>Example:</p>
<pre><code class="language-html"></code></pre>
<script>
<pre><code>    function chemdrawLoaded() {
</code></pre>
<pre><code>        cdw = new perkinelmer.ChemDrawWeb();
</code></pre>
<pre><code>        cdw.attach(&quot;cdwAnchor&quot;);
</code></pre>
<pre><code>    }
</code></pre>
<pre><code>    function showDrawingImage() {
</code></pre>
<pre><code>        var url = cdw.getImgUrl();
</code></pre>
<pre><code>        var newWindow = window.open(&quot;&quot;);
</code></pre>
<pre><code>        newWindow.document.write(&quot;&lt;img src=â€™&quot; + url + &quot;â€™/&gt;&quot;);
</code></pre>
<pre><code>   }
</code></pre>
</script>
<pre><code></code></pre>
<h3>4.1.10	getVersion()</h3>
<p>This function returns the current version of ChemDraw as a string.</p>
<h3>4.1.11	isBlankStructure()</h3>
<p>This function returns true if nothing has been drawn in ChemDraw and false if something has been drawn.</p>
<h3>4.1.12	loadConfig(configObject)</h3>
<p>This function reads a configuration object in JSON and loads the new configuration into ChemDraw.</p>
<h3>4.1.13	loadConfigFromUrl(url)</h3>
<p>This function reads a remote configuration file and loads the new configuration to ChemDraw.</p>
<h3>4.1.14	setViewOnly(viewonly)</h3>
<p>This function sets whether the user is able to interact with ChemDraw.</p>
<h3>4.1.15	fitToContainer()</h3>
<p>The tool automatically resizes to fit its container when the window resizes, but if its container resizes under other circumstances, this function must be called manually to resize ChemDraw to the new container size.</p>
<h3>4.1.16	getErrors()</h3>
<p>This function returns an array of strings describing the chemical warnings that are present in the current drawing.</p>
<h3>4.1.17	labelReactions()</h3>
<p>Deprecated, use labelFragments(IDs) instead.</p>
<p>Calling this function will add Roman numeral labels to any reactions present in the current drawing. Calling it with labels already present will remove the existing labels and reapply new ones.</p>
<h3>4.1.18	labelFragments(IDs)</h3>
<p>This API is added in CDD 1.7 to replace labelReactions(). It needs an int array of IDs to label every fragment on canvas. ID refers to &ldquo;id&rdquo; attribute of fragment node in CDXML.</p>
<p>Example:</p>
<pre><code class="language-javascript"></code></pre>
<p>labelFragments([30, 31, 32]);</p>
<pre><code></code></pre>
<h3>4.1.19	addReactant(cdxml)</h3>
<p>This function appends a new reactant to the reaction present in the current drawing. If there are reactants present, the new reactant is added to the left of the left-most reactant. If no reaction is present, a new arrow is added to the center of the canvas along with the reactant.</p>
<h3>4.1.20	addProduct(cdxml)</h3>
<p>This function appends a new product to the reaction present in the current drawing. If there are products present, the new product will be added to the right of the right-most product. If no reaction is present, a new arrow will be added to the center of the canvas along with the product.</p>
<h3>4.1.21	addReagent(cdxml)</h3>
<p>This function appends a new reagent to the reaction present in the current drawing. The reagent is added to the top of the reaction arrow and above the top-most reagent if there are any already. If no reaction is present, a new arrow is added to the center of the canvas, along with the reagent.</p>
<h3>4.1.22	getProperties(callback)</h3>
<p>This API makes an AJAX call to service, and need a callback as the parameter. The callback function is same with APIs getInChI, getSMIKES, getRXN or getMOL.</p>
<p>The first argument in the callback function is a string of JSON format containing some properties of structures drawn on canvas.</p>
<p>The returned JSON string is something similar to the string shown below (following is formatted, the actual return value is a one-line string)</p>
<pre><code class="language-json"></code></pre>
<p>{</p>
<p>&ldquo;NAME&rdquo; : &ldquo;benzene&rdquo;,</p>
<p>&ldquo;FORMULA&rdquo; : &ldquo;C6H6&rdquo;,</p>
<p>&ldquo;MW&rdquo; : &ldquo;78.1140000006 g/mol&rdquo;,</p>
<p>&ldquo;ID&rdquo; : &ldquo;24&rdquo;,</p>
<p>&ldquo;INCHI&rdquo; : &ldquo;InChI=1S/C6H6/c1-2-4-6-5-3-1/h1-6H&rdquo;,</p>
<p>&ldquo;SMILES&rdquo; : &ldquo;C1=CC=CC=C1&rdquo;</p>
<p>}</p>
<pre><code></code></pre>
<p>From top to bottom, the fields mean structure name, formula (html format, having tags like &lt;sub&gt;, &lt;sup&gt;), molecule weight, Fragment ID (same with id attribute in CDXML), InChI, SMILES.</p>
<h3>4.1.23	markAsSaved(), isSaved()</h3>
<p>These two APIs need to work together.</p>
<p>markAsSaved() does not return anything. By invoking this API, it tells CDD that the current drawings are saved.</p>
<p>isSaved() returns a boolean value. True, if the current drawings are not modified since last call to markAsSaved(); false, if changes are made after markAsSaved() is called.</p>
<h4>4.1.24	getFragmentsInfo()</h4>
<p>It returns a JavaScript array containing information of the fragments in canvas. Only the fragments having chemical meanings (structures, formulas, etc.) are included in the result. Captions (literal text), reaction arrow, brackets, etc. are not include.</p>
<p>Each entry in the array containing the bellow properties:</p>
<ul>
<li>cdxml: a string, the CDXML string of this fragment.</li>
</ul>
<ul>
<li>image: a string, the image in base64 string of this fragment.</li>
</ul>
<ul>
<li>width: a number, the width of this fragment.</li>
</ul>
<ul>
<li>height: a number, the height of this fragment.</li>
</ul>
<ul>
<li>x: a number, the x position (left-top point of this fragment).</li>
</ul>
<ul>
<li>y: a number, the y position (left-top point of this fragment).</li>
</ul>
<p><em><strong>Note</strong>: x, y, width, height are measured in CDDâ€™s coordinate system, which is not always same with the HTML position or size.</em></p>
<h3>4.1.25	nameToStructure(name, callback)</h3>
<p>It reads a structure name and returns a CDXML string representing the structure. This API in CDD 1.6 and later will not return result, the result will be returned in callback which as the second parameter when invoke this API.</p>
<p>Note: This function does not read the selected text from the drawing tool. And the generated CDXML will not be rendered on the canvas.</p>
<h3>4.1.26	structureToName(structure, callback)</h3>
<p>It reads a CDXML string and returns the name of the structure. This API in CDD 1.6 and later wonâ€™t return result, the result will be returned in callback which as the second parameter when invoke this API.</p>
<p>Note: This function does not read the CDXML from the drawing tool. And the generated name will not be pasted to the canvas.</p>
<h3>4.1.27	detectDataLoss()</h3>
<p>When loading or pasting a CDXML string into CDD, or dragging &amp; dropping a CDXML file into CDD, CDD will detect unsupported objects in the CDXML. This function returns an array of strings describing the detailed information that may cause data loss, e.g.</p>
<pre><code class="language-json"></code></pre>
<p>[</p>
<p>&ldquo;This CDXML is created by program: ChemDraw 14.0.1.9, which is not fully supported.&rdquo;,</p>
<p>&ldquo;NMR Predictions are not supported yet.&rdquo;</p>
<p>]</p>
<pre><code></code></pre>
<p>These unsupported objects are added to the canvas, but they are invisible. After calling the API clear(), these objects will be removed together with other objects.</p>
<p>If no objects are unsupported by CDD, this function returns an empty array.</p>
<h3>4.1.28	getSVG(callback)</h3>
<p>This API is used to retrieve the Scalable Vector Graphics (SVG) representation of current drawing. The SVG string is passed as the first parameter of the callback. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.29	getEPS(callback)</h3>
<p>This API is used to retrieve the Encapsulated PostScript (EPS) representation of current drawing. The EPS string is passed as the first parameter of the callback. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.30	getWMF(callback)</h3>
<p>This API is used to retrieve the Windows Metafile (WMF) representation of current drawing. The WMF blob is passed as the first parameter of the callback. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.31	 getEMF(callback)</h3>
<p>This API is used to retrieve the Enhanced Metafile (EMF) representation of current drawing. The EMF blob is passed as the first parameter of the callback. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.32	loadMOL(mol, callback)</h3>
<p>This API is used to load a MOL string to the canvas. The callback is called when the loading is completed. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.33	loadSMILES(smiles, callback)</h3>
<p>This API is used to load a SMILES string to the canvas. The callback is called when the loading is completed. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.34	loadB64CDX(base64cdx, callback)</h3>
<p>This API is used to load a base64 encoded CDX string to the canvas. The callback is called when the loading is completed. If any error happens, the error string is passed as the second parameter of the callback.</p>
<h3>4.1.35	shrinkToFit()</h3>
<p>This API can adjust the zoom level and viewport position to make all the drawing objects visible and centered on the canvas. If the canvas is not large enough to show all drawings, this API zooms out the drawings, and the drawings become smaller and centered. If the canvas is large enough to show all drawings, this API only centers the drawings.</p>
<h3>4.1.36	setContentChangedHandler(callback)</h3>
<p>This API is used to notify the changes of drawing objects. When the drawings are chang